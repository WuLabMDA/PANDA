---
title: "Untitled"
author: "Muhammad Aminu"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, message=FALSE, warning=FALSE}
library(Seurat)
library(Signac)
library(ggplot2)
library(cowplot)
library(caret)
library(ggpubr)
library(corrplot)
library(MASS)
library(Rtsne)
library(umap)
library(pheatmap)
library(RGCCA)
library(ConsensusClusterPlus)
library(mclust)
library(aricode)
library(PANDA)
```

# Introduction


# Load data

For this demo we will use a synthetic dataset simulating a scRNA-seq and scATAC-seq experimentts, generated using [MOSim](https://https://github.com/ConesaLab/MOSim).


```{r}
data("data_CancerCellLine")

rna <- data_CancerCellLine[["rna"]]
atac <- data_CancerCellLine[["atac"]]
metaData <- data_CancerCellLine[["metadata"]]
```

# Create SingleCellExperiment object
```{r}
cellLine.rna <- CreateSeuratObject(counts = rna,
                                project = "cellLine",
                                assay = "RNA",
                                meta.data = metaData)

cellLine.atac <- CreateSeuratObject(counts = atac,
                                 project = "cellLine",
                                 assay = "ATAC",
                                 meta.data = metaData)
```


```{r}
data <- list(rna = as.matrix(rna), atac = as.matrix(atac))
gnd <- as.numeric(as.factor(cellLine.rna@meta.data[["orig.ident"]]))
numComponents <- 100

PanDAModel <- PanDA(data,gnd,numComponents,0.02)

PanDARNA <- CreateDimReducObject(
  embeddings = PanDAModel[["PanDAComponents"]][["rnaComponents"]],
  loadings = PanDAModel[["projMatrices"]][["Wrna"]],
  stdev = numeric(),
  key = "DC_",
  assay = "RNA"
)

cellLine.rna@reductions[["PanDA"]] <- PanDARNA

cellLine.rna <- RunUMAP(cellLine.rna, dims = 1:100, reduction = "PanDA", reduction.name = "PanDAumap", reduction.key = "PandaUMAP_")
cellLine.rna <- RunTSNE(cellLine.rna, dims = 1:100, reduction = "PanDA", reduction.name = "PanDAtsne", reduction.key = "PandaTSNE_")
```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
